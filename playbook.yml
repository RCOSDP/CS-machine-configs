---

- name: common settings
  hosts: default
  vars_files: [ vars/common.yml ]
  roles:
    - common

- name: setup NFS server
  hosts: nfsserver
  roles:
    - nfs_server

- name: setup LDAP server
  hosts: ldapserver
  vars_files: [ vars/ldap.yml ]
  roles:
    - ldap_server

- name: setup reverse proxy for jupyterlab
  hosts: reverseproxy
  roles:
    - reverse_proxy

- name: all machines
  hosts: default
  vars_files: [ vars/ldap.yml ]
  roles:
    - nfs_client
    - ldap_client
    - ldap_sudoers
    - mpi
    - jupyterlab

- name: desktop machines
  hosts: desktop
  roles:
    - desktop_common

- name: gpu machines
  hosts: gpu
  roles:
    - nvidia_cuda_toolkit
    - nvidia_cudnn
